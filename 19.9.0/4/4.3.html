
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>GoCD Agent Â· GoCD Developer Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="GoCD Agent is the component of GoCD which runs the jobs given to it by the GoCD Server. An Agent comprises of 3 parts, the Agent Bootstrapper, the Agent Launcher and the Agent itself.">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
<meta content="gocd agent, agent bootstrapper, agent launcher, go agent, gocd agent install, gocd multiple agents" name="keywords" />

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.gocd.org" target="_blank" class="custom-link">Home</a>
        </li>
    
        
        <li>
            <a href="https://github.com/gocd/developer.go.cd/" target="_blank" class="custom-link">Contribute</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../1/1.1.html">
            
                <a href="../1/1.1.html">
            
                    
                    Concepts in GoCD
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../1/1.1.html">
            
                <a href="../1/1.1.html">
            
                    
                    Domain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    Implementation
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../2/2.1.html">
            
                <a href="../2/2.1.html">
            
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../2/2.1.html">
            
                <a href="../2/2.1.html">
            
                    
                    Setting up your development environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../2/2.2.html">
            
                <a href="../2/2.2.html">
            
                    
                    How to go about making changes to the codebase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../2/2.3.html">
            
                <a href="../2/2.3.html">
            
                    
                    How to add a configuration migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../2/2.4.html">
            
                <a href="../2/2.4.html">
            
                    
                    How to add a database migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../2/2.5.html">
            
                <a href="../2/2.5.html">
            
                    
                    Useful gradle tasks during development
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../3/3.1.html">
            
                <a href="../3/3.1.html">
            
                    
                    Technology Stack
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../3/3.1.html">
            
                <a href="../3/3.1.html">
            
                    
                    Plugins Architecture - OSGi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../3/3.2.html">
            
                <a href="../3/3.2.html">
            
                    
                    Object Relation Mapping (ORM) - Hibernate & IBatis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    Caching - EhCache
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../3/3.4.html">
            
                <a href="../3/3.4.html">
            
                    
                    Dependency Injection (DI) - Spring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Model View Controller (MVC)
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" >
            
                <span>
            
                    
                    Models - Java
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" >
            
                <span>
            
                    
                    Controllers - Servlets & Rails
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.3" >
            
                <span>
            
                    
                    Views - Rails & Velocity
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../3/3.6.html">
            
                <a href="../3/3.6.html">
            
                    
                    User Interface (UI) - jQuery & Prototype, SCSS, HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" >
            
                <span>
            
                    
                    Build Tool - Buildr
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="4.1.html">
            
                <a href="4.1.html">
            
                    
                    Architecture of GoCD
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="4.1.html">
            
                <a href="4.1.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="4.2.html">
            
                <a href="4.2.html">
            
                    
                    GoCD Server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="4.2.html">
            
                <a href="4.2.html#521-configuration-management">
            
                    
                    Configuration Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1.1" data-path="4.2.html">
            
                <a href="4.2.html#5211-xsd--xml">
            
                    
                    XSD & XML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.2" data-path="4.2.html">
            
                <a href="4.2.html#5212-schema-migration">
            
                    
                    Schema Migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.3" data-path="4.2.html">
            
                <a href="4.2.html#5213-config-repository">
            
                    
                    Config Repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.4" data-path="4.2.html">
            
                <a href="4.2.html#5214-config-merge">
            
                    
                    Config Merge
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.5" data-path="4.2.html">
            
                <a href="4.2.html#5215-config-diff">
            
                    
                    Config Diff
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="4.2.html">
            
                <a href="4.2.html#522-database-management">
            
                    
                    Database Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.2.1" data-path="4.2.html">
            
                <a href="4.2.html#5221-schema">
            
                    
                    Schema
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2.2" data-path="4.2.html">
            
                <a href="4.2.html#5222-database-migrations">
            
                    
                    Migration - DBDeploy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2.3" data-path="4.2.html">
            
                <a href="4.2.html#5223-backup">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="4.2.html">
            
                <a href="4.2.html#523-material-update-sub-system-mdu">
            
                    
                    Material Update Sub System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.3.1" data-path="4.2.html">
            
                <a href="4.2.html#5231-material-fingerprint--flyweights">
            
                    
                    Material Fingerprint & Flyweights
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3.2" data-path="4.2.html">
            
                <a href="4.2.html#5232-supported-materials">
            
                    
                    Supported Materials
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="4.2.html">
            
                <a href="4.2.html#524-build-cause-production">
            
                    
                    Build Cause Production
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="4.2.html">
            
                <a href="4.2.html#525-pipeline-scheduling">
            
                    
                    Pipeline Scheduling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="4.2.html">
            
                <a href="4.2.html#526-work-assignment">
            
                    
                    Work Assignment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.6.1" data-path="4.2.html">
            
                <a href="4.2.html#5261-resource--environment-mapping">
            
                    
                    Resource & Environment Mapping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.7" data-path="4.2.html">
            
                <a href="4.2.html#527-artifact-management">
            
                    
                    Artifact Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8" data-path="4.2.html">
            
                <a href="4.2.html#528-user-management">
            
                    
                    User Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.8.1" data-path="4.2.html">
            
                <a href="4.2.html#5281-authentication-management">
            
                    
                    Authentication Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8.2" data-path="4.2.html">
            
                <a href="4.2.html#5282-enable-disable--delete-users">
            
                    
                    Enable, disable & delete users
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8.3" data-path="4.2.html">
            
                <a href="4.2.html#5283-user-role-management">
            
                    
                    User Role Management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.9" data-path="4.2.html">
            
                <a href="4.2.html#529-agent-management">
            
                    
                    Agent Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10" data-path="4.2.html">
            
                <a href="4.2.html#5210-user-interface-architecture">
            
                    
                    UI Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.10.1" data-path="4.2.html">
            
                <a href="4.2.html#52101-markup--html">
            
                    
                    Markup : HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10.2" data-path="4.2.html">
            
                <a href="4.2.html#52102-styling--css-sass">
            
                    
                    Styling: CSS, SASS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10.3" data-path="4.2.html">
            
                <a href="4.2.html#52103-scripting-javascript-jquery-and-prototype">
            
                    
                    Scripting : JavaScript, jQuery and Prototype
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.11" data-path="4.2.html">
            
                <a href="4.2.html#5211-apis-cctray--feeds">
            
                    
                    APIs, CCTray & Feeds
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.5.3" data-path="4.3.html">
            
                <a href="4.3.html">
            
                    
                    GoCD Agent
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="4.3.html">
            
                <a href="4.3.html#agent-overview">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="4.3.html">
            
                <a href="4.3.html#agent-bootstrapper">
            
                    
                    Bootstrapper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="4.3.html">
            
                <a href="4.3.html#agent-launcher">
            
                    
                    Launcher
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.4" data-path="4.3.html">
            
                <a href="4.3.html#agent">
            
                    
                    Agent
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="4.4.html">
            
                <a href="4.4.html">
            
                    
                    Common
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="4.4.1.html">
            
                <a href="4.4.1.html">
            
                    
                    Plugin Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" >
            
                <span>
            
                    
                    [Agent - Server Communication](
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="4.5.html">
            
                <a href="4.5.html">
            
                    
                    Build Infrastructure
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1" data-path="4.5.html">
            
                <a href="4.5.html#packaging">
            
                    
                    Build, Test, Package
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1.1" data-path="4.5.html">
            
                <a href="4.5.html#modules">
            
                    
                    Maven modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.1.2" data-path="4.5.html">
            
                <a href="4.5.html#documentation-creation">
            
                    
                    Documentation Creation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.1.3" data-path="4.5.html">
            
                <a href="4.5.html#pom-conventions">
            
                    
                    Pom conventions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.1.4" data-path="4.5.html">
            
                <a href="4.5.html#jar-packaging">
            
                    
                    Jar Packaging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.1.5" data-path="4.5.html">
            
                <a href="4.5.html#tlb-integration">
            
                    
                    TLB integration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.5.2" data-path="4.5.html">
            
                <a href="4.5.html#installer-creation">
            
                    
                    Installer Creation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.2.1" data-path="4.5.html">
            
                <a href="4.5.html#zip">
            
                    
                    Zip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2.2" data-path="4.5.html">
            
                <a href="4.5.html#rpm">
            
                    
                    RPM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2.3" data-path="4.5.html">
            
                <a href="4.5.html#debian">
            
                    
                    Debian
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2.4" data-path="4.5.html">
            
                <a href="4.5.html#windows">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2.5" data-path="4.5.html">
            
                <a href="4.5.html#mac-osx">
            
                    
                    Mac OS X
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html">
            
                    
                    Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html">
            
                    
                    Dashboard
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html#611-personalise">
            
                    
                    Personalise
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html#612-search">
            
                    
                    Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.3" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html#613-pipeline-groups">
            
                    
                    Pipeline Group(s)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.4" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html#614-pipelines-and-ordering-of-pipeline-instances">
            
                    
                    Pipeline(s) and Ordering of pipeline instances
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.5" data-path="../5/5.1.html">
            
                <a href="../5/5.1.html#615-active-pipelines">
            
                    
                    Active Pipelines
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html">
            
                    
                    Fan-in
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html#overview">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html#pipeline-timeline">
            
                    
                    Pipeline Timeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html#algorithm">
            
                    
                    Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html#corner-cases">
            
                    
                    Corner Cases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="../5/5.2.html">
            
                <a href="../5/5.2.html#extensions">
            
                    
                    Extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html">
            
                    
                    Value Stream Map
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html#overview">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html#layer-assignment">
            
                    
                    Layer Assignment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html#dummy-node-creation">
            
                    
                    Dummy Node Creation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.4" data-path="../5/5.3.<md id="edge-cross-mini"></md>mization">
            
                <span>
            
                    
                    Edge Cross Minimisation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.5" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html#corner-cases">
            
                    
                    Corner Cases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.6" data-path="../5/5.3.html">
            
                <a href="../5/5.3.html#extensions">
            
                    
                    Extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../5/5.4.html">
            
                <a href="../5/5.4.html">
            
                    
                    Compare Pipeline
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="../5/5.4.html">
            
                <a href="../5/5.4.html#641-overview">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="../5/5.4.html">
            
                <a href="../5/5.4.html#642-implementation">
            
                    
                    Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="../5/5.4.html">
            
                <a href="../5/5.4.html#643-corner-cases">
            
                    
                    Corner cases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../5/5.5.html">
            
                <a href="../5/5.5.html">
            
                    
                    PackageRepository
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.5.1" data-path="../5/5.5.html">
            
                <a href="../5/5.5.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.2" data-path="../5/5.5.html">
            
                <a href="../5/5.5.html#package-configuration">
            
                    
                    Capturing Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5.3" data-path="../5/5.5.html">
            
                <a href="../5/5.5.html#package-revision">
            
                    
                    Retrieving Package Revisions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.6" >
            
                <span>
            
                    
                    Command Repository
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../5/5.7.html">
            
                <a href="../5/5.7.html">
            
                    
                    Environments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" >
            
                <span>
            
                    
                    Templates
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" >
            
                <span>
            
                    
                    Shine
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.9.1" >
            
                <span>
            
                    
                    Test Artifact Parser
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9.2" >
            
                <span>
            
                    
                    Reporting
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9.3" >
            
                <span>
            
                    
                    Stage Graph
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../5/5.10.html">
            
                <a href="../5/5.10.html">
            
                    
                    OAuth Gadgets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../5/5.11.html">
            
                <a href="../5/5.11.html">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../writing_go_plugins/overview.html">
            
                <a href="../writing_go_plugins/overview.html">
            
                    
                    Writing GoCD Plugins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="4.4.1.html">
            
                <a href="4.4.1.html">
            
                    
                    GoCD Plugin Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../writing_go_plugins/go_plugins_basics.html">
            
                <a href="../writing_go_plugins/go_plugins_basics.html">
            
                    
                    GoCD Plugin Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../writing_go_plugins/go_plugin_api.html">
            
                <a href="../writing_go_plugins/go_plugin_api.html">
            
                    
                    GoCD Plugin API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../writing_go_plugins/json_message_based_plugin_api.html">
            
                <a href="../writing_go_plugins/json_message_based_plugin_api.html">
            
                    
                    JSON message based plugin API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.4.1" data-path="../writing_go_plugins/angular_js_templates_in_go_plugins.html">
            
                <a href="../writing_go_plugins/angular_js_templates_in_go_plugins.html">
            
                    
                    Writing AngularJS templates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4.2" data-path="../writing_go_plugins/plugin_settings/plugin_settings_overview.html">
            
                <a href="../writing_go_plugins/plugin_settings/plugin_settings_overview.html">
            
                    
                    Plugin Settings
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.4.2.1" data-path="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_configuration.html">
            
                <a href="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_configuration.html">
            
                    
                    Get Plugin Settings Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4.2.2" data-path="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_view.html">
            
                <a href="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_view.html">
            
                    
                    Get Plugin Settings View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4.2.3" data-path="../writing_go_plugins/plugin_settings/version_1_0/validate_plugin_settings.html">
            
                <a href="../writing_go_plugins/plugin_settings/version_1_0/validate_plugin_settings.html">
            
                    
                    Validate Plugin Settings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../writing_go_plugins/go_application_accessor/go_application_accessor.html">
            
                <a href="../writing_go_plugins/go_application_accessor/go_application_accessor.html">
            
                    
                    GoCD Application Accessor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.1" data-path="../writing_go_plugins/go_application_accessor/plugin_settings/plugin_settings.html">
            
                <a href="../writing_go_plugins/go_application_accessor/plugin_settings/plugin_settings.html">
            
                    
                    Plugin Settings
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.1.1" data-path="../writing_go_plugins/go_application_accessor/plugin_settings/version_1_0/get_plugin_settings.html">
            
                <a href="../writing_go_plugins/go_application_accessor/plugin_settings/version_1_0/get_plugin_settings.html">
            
                    
                    Get Plugin Settings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.5.2" data-path="../writing_go_plugins/go_application_accessor/user_session/user_session.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user_session/user_session.html">
            
                    
                    User Session
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.2.1" data-path="../writing_go_plugins/go_application_accessor/user_session/version_1_0/put_into_user_session.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/put_into_user_session.html">
            
                    
                    Put into Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.2.2" data-path="../writing_go_plugins/go_application_accessor/user_session/version_1_0/get_from_user_session.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/get_from_user_session.html">
            
                    
                    Get from Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.2.3" data-path="../writing_go_plugins/go_application_accessor/user_session/version_1_0/remove_from_user_session.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/remove_from_user_session.html">
            
                    
                    Remove from Session
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.5.3" data-path="../writing_go_plugins/go_application_accessor/user/user.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user/user.html">
            
                    
                    Authenticate User
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.3.1" data-path="../writing_go_plugins/go_application_accessor/user/version_1_0/authenticate_user.html">
            
                <a href="../writing_go_plugins/go_application_accessor/user/version_1_0/authenticate_user.html">
            
                    
                    Authenticate User
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../writing_go_plugins/package_material/package_material_plugin_overview.html">
            
                <a href="../writing_go_plugins/package_material/package_material_plugin_overview.html">
            
                    
                    Package material plugins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.6.1" data-path="../writing_go_plugins/package_material/json_message_based_package_material_extension.html">
            
                <a href="../writing_go_plugins/package_material/json_message_based_package_material_extension.html">
            
                    
                    JSON API - Message based
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.6.1.1" data-path="../writing_go_plugins/package_material/version_1_0/repository_configuration.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/repository_configuration.html">
            
                    
                    Repository Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.2" data-path="../writing_go_plugins/package_material/version_1_0/package_configuration.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/package_configuration.html">
            
                    
                    Package Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.3" data-path="../writing_go_plugins/package_material/version_1_0/validate_repository_configuration.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/validate_repository_configuration.html">
            
                    
                    Validate Repository Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.4" data-path="../writing_go_plugins/package_material/version_1_0/validate_package_configuration.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/validate_package_configuration.html">
            
                    
                    Validate Package Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.5" data-path="../writing_go_plugins/package_material/version_1_0/check_repository_connection.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/check_repository_connection.html">
            
                    
                    Check Repository Connection Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.6" data-path="../writing_go_plugins/package_material/version_1_0/check_package_connection.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/check_package_connection.html">
            
                    
                    Check Package Connection Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.7" data-path="../writing_go_plugins/package_material/version_1_0/latest_revision.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/latest_revision.html">
            
                    
                    Latest Revision Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.1.8" data-path="../writing_go_plugins/package_material/version_1_0/latest_revision_since.html">
            
                <a href="../writing_go_plugins/package_material/version_1_0/latest_revision_since.html">
            
                    
                    Latest Revision Since Request
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../writing_go_plugins/scm_material/scm_material_plugin_overview.html">
            
                <a href="../writing_go_plugins/scm_material/scm_material_plugin_overview.html">
            
                    
                    SCM material plugins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.7.1" data-path="../writing_go_plugins/scm_material/json_message_based_scm_material_extension.html">
            
                <a href="../writing_go_plugins/scm_material/json_message_based_scm_material_extension.html">
            
                    
                    JSON API - Message based
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.7.1.1" data-path="../writing_go_plugins/scm_material/version_1_0/scm_configuration.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/scm_configuration.html">
            
                    
                    SCM Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.2" data-path="../writing_go_plugins/scm_material/version_1_0/view.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/view.html">
            
                    
                    SCM View Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.3" data-path="../writing_go_plugins/scm_material/version_1_0/validate_scm_configuration.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/validate_scm_configuration.html">
            
                    
                    Validate SCM Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.4" data-path="../writing_go_plugins/scm_material/version_1_0/check_scm_connection.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/check_scm_connection.html">
            
                    
                    Check SCM Connection Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.5" data-path="../writing_go_plugins/scm_material/version_1_0/latest_revision.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/latest_revision.html">
            
                    
                    Latest Revision Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.6" data-path="../writing_go_plugins/scm_material/version_1_0/latest_revisions_since.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/latest_revisions_since.html">
            
                    
                    Latest Revisions Since Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.1.7" data-path="../writing_go_plugins/scm_material/version_1_0/checkout.html">
            
                <a href="../writing_go_plugins/scm_material/version_1_0/checkout.html">
            
                    
                    Checkout Request
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../writing_go_plugins/task/task_plugin_overview.html">
            
                <a href="../writing_go_plugins/task/task_plugin_overview.html">
            
                    
                    Task plugins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.8.1" data-path="../writing_go_plugins/task/json_message_based_task_extension.html">
            
                <a href="../writing_go_plugins/task/json_message_based_task_extension.html">
            
                    
                    JSON API - Message based
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.8.1.1" data-path="../writing_go_plugins/task/version_1_0/configuration.html">
            
                <a href="../writing_go_plugins/task/version_1_0/configuration.html">
            
                    
                    Task Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.1.2" data-path="../writing_go_plugins/task/version_1_0/validate.html">
            
                <a href="../writing_go_plugins/task/version_1_0/validate.html">
            
                    
                    Validate Configuration Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.1.3" data-path="../writing_go_plugins/task/version_1_0/execute.html">
            
                <a href="../writing_go_plugins/task/version_1_0/execute.html">
            
                    
                    Execute Task Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.1.4" data-path="../writing_go_plugins/task/version_1_0/view.html">
            
                <a href="../writing_go_plugins/task/version_1_0/view.html">
            
                    
                    Task View Request
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="../writing_go_plugins/notification/notification_plugin_overview.html">
            
                <a href="../writing_go_plugins/notification/notification_plugin_overview.html">
            
                    
                    Notification plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="../writing_go_plugins/angular_js_templates_in_go_plugins.html">
            
                <a href="../writing_go_plugins/angular_js_templates_in_go_plugins.html">
            
                    
                    Angular JS templates in GoCD plugins
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../7/7.1.html">
            
                <a href="../7/7.1.html">
            
                    
                    CD in practice
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../7/7.1.html">
            
                <a href="../7/7.1.html">
            
                    
                    Build GoCD Using GoCD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html">
            
                    
                    Test Infrastructure
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#721-rails-specs-using-rspec">
            
                    
                    Rails specs using RSpec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#722-java-testing-using-junit">
            
                    
                    Java testing using JUnit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#723-javascript-testing-using-jsunit-tests">
            
                    
                    Javascript testing using JsUnit Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#724-acceptance--regression-tests-using-twist">
            
                    
                    Acceptance & Regression tests using Twist
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.4.1" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#725-performance-tests">
            
                    
                    Performance Tests
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../7/7.2.html">
            
                <a href="../7/7.2.html#726-test-parallelization">
            
                    
                    Test Parallelization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" >
            
                <span>
            
                    
                    Continuous Deployment
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../8/8.1.html">
            
                <a href="../8/8.1.html">
            
                    
                    Miscellaneous
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../8/8.1.html">
            
                <a href="../8/8.1.html">
            
                    
                    Technical Debt
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >GoCD Agent</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="43-gocd-agent"><a name="43-gocd-agent" class="plugin-anchor" href="#43-gocd-agent"><i class="fa fa-link" aria-hidden="true"></i></a>4.3 GoCD Agent</h2>
<h3 id="431-overview"><a name="431-overview" class="plugin-anchor" href="#431-overview"><i class="fa fa-link" aria-hidden="true"></i></a><a name="agent-overview"></a>4.3.1 Overview</h3>
<p>GoCD Agent is the component of GoCD which runs the jobs given to it by the GoCD Server. An Agent comprises of 3 parts, the Agent Bootstrapper, the Agent Launcher and the Agent itself.</p>
<p><img src="images/agent_overview.png" alt="Agent Overview"></p>
<h3 id="432-bootstrapper"><a name="432-bootstrapper" class="plugin-anchor" href="#432-bootstrapper"><i class="fa fa-link" aria-hidden="true"></i></a><a name="agent-bootstrapper"></a>4.3.2 Bootstrapper</h3>
<p>The bootstrapper is the only component of a GoCD agent that requires a manual upgrade, therefore its code is kept to a bare minimum to avoid this manual upgrade.</p>
<p>A new installation of an agent has only the agent-bootstrapper.jar. When you start an agent, it essentially starts the agent-bootstrapper.jar, which does the following: </p>
<ol>
<li>Facilitate the automatic upgrade of the agent-launcher.</li>
<li>Launches the agent-launcher.</li>
<li>If at any point the launcher process is killed, the bootstrapper re-launches it as long as the boostrapper process is still running.</li>
</ol>
<p><strong>How does the bootstrapper facilitate automatic upgrade of the launcher and launch it?</strong></p>
<p>The agent-launcher.jar is packaged inside the agent-bootstrapper.jar. When the bootstrapper starts, it starts the launcher by doing the following:</p>
<ol>
<li>Creates a temporary launcher jar, with the format [UUID]agent-launcher.jar, by copying over the agent-launcher.jar.</li>
<li>Reads the values of specific keys from <code>MANIFEST.MF</code> of the agent-launcher.jar. This is done to determine which class needs to be launched from the Launcher.</li>
<li>Gets the <code>AgentLauncher</code> class.</li>
<li>Launches the launcher by calling the launch method on the <code>AgentLauncher</code> class.</li>
</ol>
<p>This agent is launched this way inorder to prevent the launcher from being launched as a separate java process while still maintaining it as a component on its own.</p>
<p>The bootstrapper logs to go-agent-bootstrapper.log file.</p>
<h3 id="433-launcher"><a name="433-launcher" class="plugin-anchor" href="#433-launcher"><i class="fa fa-link" aria-hidden="true"></i></a><a name="agent-launcher"></a>4.3.3 Launcher</h3>
<p>Once the launcher is launched, it does the following:</p>
<ol>
<li>Creates a lockfile. The purpose of the lockfile is to prevent multiple instances of the bootstrapper from being launched using the same agent-bootstrapper.jar, i.e., if you want to run two agents on the same box, they should not be started in the same location as it would interfere with the working of the agents. </li>
<li>Checks to see if a new version of the agent-launcher.jar is available. This is done by comparing the <code>md5</code> checksum of the agent-launcher.jar present locally with the agent-launcher.jar on the GoCD Server. If the launcher is upgrades itself, it returns and it is then restarted by the bootstrapper.</li>
<li>Downloads the agent.jar from the Go server if required. It then starts the agent by determining the starting point of the agent, <code>AgentProcessParentImpl</code>, by reading specific keys from <code>MANIFEST.MF</code> of the agent.jar and starting it.</li>
</ol>
<p>The launcher allows for the automatic upgradation of the agent without manual intervention.</p>
<p>The agent launcher logs to the go-agent-launcher.log file.</p>
<h3 id="434-agent"><a name="434-agent" class="plugin-anchor" href="#434-agent"><i class="fa fa-link" aria-hidden="true"></i></a><a name="agent"></a>4.3.4 Agent</h3>
<p>The agent is responsible for running a job given to it by the server.</p>
<p>The starting point for an agent is the <code>AgentProcessParentImpl</code>. At this point three things happen, agent is downloaded if required (this is done twice - once in the launcher and once at this point, this is to maintain backward compatibility with agents prior to version 2.3, where the launcher module was not present), plugins are downloaded if required, and the agent.jar is launched as a separate java process.</p>
<p>Agents are uniquely identified by the server based on their UUID. Information about all agent instances are stored in-memory on the GoCD server.</p>
<p>At any given time, an agent has to be in one of the following states:</p>
<ol>
<li>Pending - until an adminitrator enables it for the very first time and that&apos;s how agent details come into the config.</li>
<li>Idle - when it is not running any jobs.</li>
<li>Preparing - when it is preparing to run the job given to it by the server, for example - checking out the source code.</li>
<li>Building - when it is running the job given to it by the server.</li>
<li>Lost Contact - if it does not ping the server for more than 5 minutes.</li>
<li>Missing - if the agent is restarted when an agent is in the lost contact state.</li>
<li>Disabled - when an agent is disabled manually by an administrator.</li>
</ol>
<p>An agent has 3 threads running as part of it:</p>
<ol>
<li>Ping Thread - runs every 5 seconds, to inform the server that the agent is alive. It also informs the server of the agents runtime information. </li>
<li>Loop/Worker Thread - The first time an agent comes up, the loop thread, which runs every 10 seconds, registers it with the server. Once this is done, it checks for agent upgrade and also retrieves work from the server.</li>
<li>Instruction Execution Thread - which runs every 10 seconds to check if the server has issued a job cancel instruction. A separate thread is maintained as a job cancel instruction is an asynchronous action, it might occur at any time and hence, it has to be monitored constantly.</li>
</ol>
<h4 id="4341-upgrade"><a name="4341-upgrade" class="plugin-anchor" href="#4341-upgrade"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.4.1 Upgrade</h4>
<p>In most situations, the GoCD agent services keep running while the server is upgraded. The loop thread checks to see if the agent needs to be upgraded every time it runs. So, the first time the loop thread contacts the server after a server upgrade, it realizes that the agent needs to be upgraded. The agent kills itself as a result of this. The agent launcher then upgrades and restarts the agent.</p>
<h4 id="4342-initialization"><a name="4342-initialization" class="plugin-anchor" href="#4342-initialization"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.4.2 Initialization</h4>
<p>Agent initialization happens through Spring. The first time the AgentController bean is initialized, it creates the following:</p>
<ol>
<li>Pipelines folder - the location where the agent will check out the source code to run the jobs on.</li>
<li>Secure Socket Layer (SSL) Infratstucture - communication infrastructure that an agent uses to communicate with the server. </li>
<li>Global Unique Identifier (GUID) - with which the agent identifies itself with the server. As part of this procces the GUID of the agent is stored in the guid.txt, present under the config folder of the agent working directory.</li>
</ol>
<p>The initial communication, up until registration, between the server and agent happens over HTTP. Once the registration is complete, the communication between the server and agent happens over HTTPS. </p>
<h4 id="4343-registration"><a name="4343-registration" class="plugin-anchor" href="#4343-registration"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.4.3 Registration</h4>
<p>Registration of the agent with the server happens when the loop thread is first initialized. Since, a number of agents can contact the server at the same time, the registration process might not be successful the very first time itself. So, the agent keeps trying to register itself every 10 seconds until it is successful.</p>
<p><em>Agent Side</em></p>
<pre><code>loop_thread()
    agent_registration()
    setup_ssl_infrastructure()
    retrieve_agent_cookie()
end
</code></pre><p>Registration of the agent involves setting up the following:</p>
<ol>
<li>Agent Certificate.</li>
<li>Agent Trust Store.</li>
<li>Agent Cookie.</li>
<li>SSL infratructure between the server and agent.</li>
</ol>
<p>Once the agent requests registration form the server, the server does the following:</p>
<p><em>Server Side</em></p>
<pre><code>registration_request_from_agent()
    auto_register_agent_if_required()
    allAgentInstances.registerNewAgent()
    assign_certification()
end

assign_certification()
    assign_agent_x509_certificate
    assign_agent_trust_store
end
</code></pre><p>When an agent is initially registered with the server, it is in the pending state until a Go administrator manually enables the agent. This is mainly done to prevent malicious agents from automatically enabling themselves on the server.</p>
<p><strong>Auto Registering Agents</strong></p>
<p>In the case where you want to enable an agent automatically with the server, you can do so by creating the agent-registration.properties file. Through this file you can specify which resources and environments the agent belongs to. When the agent initially tries to register itself with the server, the server checks to see if the incoming request has an agent-registration.properties file <code>auto_register_agent_if_required()</code>, if so then it sets up the agent with the resources and environments specified in this file. The agent will be in the enabled state after this.</p>
<h4 id="4344-retrieve--build-work"><a name="4344-retrieve--build-work" class="plugin-anchor" href="#4344-retrieve--build-work"><i class="fa fa-link" aria-hidden="true"></i></a>4.3.4.4 Retrieve &amp; Build Work</h4>
<p>Once the agent is enabled on the server, it is by default in the &quot;idle&quot; state, indicating that the agent is not doing any work. The loop thread then requests the server for work. </p>
<p><em>Server Side</em></p>
<pre><code>getWork()
    if_agent_has_not_been_assigned_work_yet_then
        idleAgentsTopic.post(agent_idle_details)
        return_no_work
    else_if_agent_is_assigned_work
        return_work
end
</code></pre><p>A listener, i.e., the <code>WorkFinder</code>, is registered on the IdleAgentsTopic queue, so when an idle agent detail is added to this queue the following happens:</p>
<p><em>Server Side</em></p>
<pre><code>assignWork()
    buildAssignmentService.assignWork(agent_details)
</code></pre><p>Once the server assigns work to the agent, this work is picked up by the agent the next time the loop thread contacts the server, which is 10 seconds later. As such, a <code>JobPlan</code> is provided to the agent, this is a copy of the job that has been configured on the server. </p>
<p>The agent then goes into the &quot;Preparing&quot; state while it is preparing to run the job. It then goes into the &quot;Building&quot; state once it begins to run the job, which happens through <code>BuildWork</code>.</p>
<p>The agent communicates its entire transition, from being assigned a job to completing the job, constantly with the server through the <code>GoPublisher</code>. The output of the task being run is contantly updated in the go-agent.log through the <code>GoControlLog</code>, and this is the information that is available on the console log of the server for that particular task.  </p>
<p>The agent logs to the go-agent.log file.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="4.2.html#5211-apis-cctray--feeds" class="navigation navigation-prev " aria-label="Previous page: APIs, CCTray & Feeds">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="4.3.html#agent-overview" class="navigation navigation-next " aria-label="Next page: Overview">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"description":"GoCD Agent is the component of GoCD which runs the jobs given to it by the GoCD Server. An Agent comprises of 3 parts, the Agent Bootstrapper, the Agent Launcher and the Agent itself.","keywords":"gocd agent, agent bootstrapper, agent launcher, go agent, gocd agent install, gocd multiple agents","title":"GoCD Agent","level":"1.5.3","depth":2,"next":{"title":"Overview","level":"1.5.3.1","depth":3,"anchor":"#agent-overview","path":"4/4.3.md","ref":"4/4.3.md#agent-overview","articles":[]},"previous":{"title":"APIs, CCTray & Feeds","level":"1.5.2.11","depth":3,"anchor":"#5211-apis-cctray--feeds","path":"4/4.2.md","ref":"4/4.2.md#5211-apis-cctray--feeds","articles":[]},"dir":"ltr"},"config":{"plugins":["highlight@2.0.3","anchors@0.7.1","ga@1.0.1","redirect@0.0.7","collapsible-menu@1.0.3"],"root":"source","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"collapsible-menu":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":{"allowLinker":true},"token":"UA-48357651-4"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"redirect":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"INTRO.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"GoCD Developer Documentation","links":{"sidebar":{"Home":"https://www.gocd.org","Contribute":"https://github.com/gocd/developer.go.cd/"},"sharing":{"google":"https://www.gocd.org","facebook":"https://www.gocd.org","twitter":"https://www.gocd.org","all":"https://www.gocd.org"}},"gitbook":"3.2.2","description":"Documentation describing the development environment, technology stack and architecture of GoCD."},"file":{"path":"4/4.3.md","mtime":"2019-09-26T07:33:29.929Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2019-09-26T07:34:48.656Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

